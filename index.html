<!doctype html>

<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Handi Dev • Device Insight — Ultra</title>
  <meta name="theme-color" content="#071018" />
  <link rel="manifest" href="/manifest.json" />
  <style>
    :root{--bg:#071018;--card:#0f1720;--text:#dff8f6;--muted:#9fbfc8;--accent:#00ffc6;--accent-2:#00c2ff;--glass:rgba(255,255,255,0.03);--radius:14px}
    [data-theme='light']{--bg:#f6fbff;--card:#fff;--text:#032027;--muted:#4b6b74;--glass:rgba(0,0,0,0.03)}
    *{box-sizing:border-box}html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;background:linear-gradient(180deg,var(--bg),#071018);color:var(--text)}
    .wrap{max-width:1200px;margin:18px auto;padding:18px}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;font-weight:800;color:#001}
    h1{margin:0;font-size:20px}
    .subtitle{color:var(--muted);font-size:13px}
    .controls{display:flex;gap:10px;align-items:center}
    .btn{background:linear-gradient(90deg,var(--accent-2),var(--accent));border:none;padding:8px 12px;border-radius:10px;color:#001;font-weight:700;cursor:pointer}
    .toggle{background:var(--card);border:1px solid rgba(255,255,255,0.04);padding:8px;border-radius:12px;cursor:pointer}
    .badges{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px;margin-top:18px}
    .badge{background:linear-gradient(180deg,var(--glass),transparent);padding:12px;border-radius:12px;border:1px solid rgba(0,255,198,0.06)}
    .k{font-size:12px;color:var(--muted)}.v{font-weight:800;font-size:16px;margin-top:6px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:16px;margin-top:18px}
    .card{background:var(--card);padding:16px;border-radius:12px;border:1px solid rgba(255,255,255,0.03)}
    .small{font-size:12px;color:var(--muted);margin-top:8px}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,monospace}
    .row{display:flex;gap:8px;flex-wrap:wrap}
    .footer{margin:22px 0;color:var(--muted);font-size:13px}
    .overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.45);z-index:9999;backdrop-filter:blur(4px);visibility:hidden;opacity:0;transition:all .18s}
    .overlay.show{visibility:visible;opacity:1}
    .loader{background:var(--card);padding:18px;border-radius:12px;display:flex;gap:12px;align-items:center}
    .dot{width:10px;height:10px;border-radius:50%;background:var(--accent);animation:blink 1s infinite}
    @keyframes blink{50%{opacity:0.25;transform:scale(.8)}}
    .cols{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width:920px){.cols{grid-template-columns:1fr}}
  </style>
  <!-- external libs (Chart.js, jsPDF, QR) loaded on demand -->
</head>
<body>
  <div class="wrap" id="app">
    <header>
      <div class="brand">
        <div class="logo">HD</div>
        <div>
          <h1>Handi Dev • Device Insight — Ultra</h1>
          <div class="subtitle">100x lebih canggih — diagnostics, fingerprint, media, network, AI heuristics</div>
        </div>
      </div>
      <div class="controls">
        <button class="toggle btn" id="themeBtn">Theme</button>
        <button class="toggle btn" id="copyAll">Copy</button>
        <button class="toggle btn" id="exportJSON">JSON</button>
        <button class="toggle btn" id="exportPDF">PDF</button>
        <button class="toggle btn" id="signinGoogle">Sign in Google</button>
      </div>
    </header><div class="badges">
  <div class="badge"><div class="k">Today</div><div class="v" id="today">—</div></div>
  <div class="badge"><div class="k">Local</div><div class="v" id="clock-local">--:--:--</div></div>
  <div class="badge"><div class="k">WIB</div><div class="v" id="clock-wib">--:--:--</div></div>
  <div class="badge"><div class="k">TimeZone</div><div class="v" id="region">—</div></div>
</div>

<div class="grid">
  <div class="card">
    <h3>Device & Browser</h3>
    <div class="v" id="device">—</div>
    <div class="small mono" id="ua">—</div>
    <div class="small" id="browserEngine">Engine: —</div>
    <div class="small" id="browserVersion">Version: —</div>
    <div class="small" id="osVersion">OS detail: —</div>
  </div>

  <div class="card">
    <h3>GPU & WebGL</h3>
    <div class="v" id="gpu">—</div>
    <div class="small" id="webglInfo">WebGL: —</div>
    <div style="margin-top:8px" class="row"><button class="btn" id="gpuBench">GPU Bench</button><div id="gpuRes" class="small">—</div></div>
  </div>

  <div class="card">
    <h3>Network & IP</h3>
    <div class="v mono" id="ip">—</div>
    <div class="small">ISP: <span id="isp">—</span> • ASN: <span id="asn">—</span></div>
    <div class="row" style="margin-top:8px"><button class="btn" id="btn-ip">Refresh IP</button><button class="btn" id="localIP">Local IP</button><button class="btn" id="checkVPN">VPN?</button></div>
    <div class="small" id="netRes">—</div>
  </div>

  <div class="card">
    <h3>Media & Camera</h3>
    <div class="v" id="mediaDevices">—</div>
    <div class="small">Default cam resolution: <span id="camRes">—</span></div>
    <div style="margin-top:8px" class="row"><button class="btn" id="scanCam">Detect Cameras</button><button class="btn" id="camTest">Test Camera</button><button class="btn" id="screenshotBtn">Screenshot</button></div>
    <video id="preview" autoplay playsinline style="width:100%;margin-top:8px;border-radius:8px;display:none"></video>
  </div>

  <div class="card">
    <h3>Local IP & WebRTC</h3>
    <div class="v mono" id="localIPs">—</div>
    <div class="small">This uses WebRTC (best-effort)</div>
  </div>

  <div class="card">
    <h3>Sensors & Orientation</h3>
    <div class="v" id="sensorVal">—</div>
    <div class="small">Light / Motion / Orientation jika tersedia</div>
  </div>

  <div class="card">
    <h3>Fingerprint</h3>
    <div class="v mono" id="fingerprint">—</div>
    <div class="small">Hash dari UA, WebGL, fonts, timezone, device</div>
  </div>

  <div class="card">
    <h3>AdBlock & Incognito</h3>
    <div class="v" id="adblock">—</div>
    <div class="small" id="incognito">Incognito: —</div>
  </div>

  <div class="card">
    <h3>Performance</h3>
    <div class="v" id="sys">—</div>
    <div class="small">Cores: <span id="cores">—</span> • RAM: <span id="ram">—</span> GB • JS Heap: <span id="heap">—</span></div>
    <div style="margin-top:8px" class="row"><button class="btn" id="benchBtn">CPU Bench</button><div id="benchRes" class="small">—</div></div>
  </div>

  <div class="card">
    <h3>AI Insight & Recommendations</h3>
    <div class="v" id="aiInsight">—</div>
    <div class="small">Rekomendasi otomatis berdasarkan data</div>
  </div>

  <div class="card cols">
    <div>
      <h3>Export / Save</h3>
      <div class="row" style="margin-top:8px"><button class="btn" id="exportJSON">Export JSON</button><button class="btn" id="exportCSV">CSV</button><button class="btn" id="exportXLSX">XLSX</button></div>
    </div>
    <div>
      <h3>Utilities</h3>
      <div class="row" style="margin-top:8px"><button class="btn" id="qrBtn">QR</button><button class="btn" id="notifyBtn">Push</button><button class="btn" id="fsAccess">FS Access</button></div>
    </div>
  </div>

</div>

<div class="footer">Catatan: Beberapa deteksi memerlukan izin. Fitur Google Sign-In perlu Client ID & server token verification. Semua data tetap disimpan lokal kecuali pengguna mengizinkan upload.</div>

  </div>  <div class="overlay" id="overlay"><div class="loader"><div class="dot"></div><div><div id="overlayTxt">Loading…</div><div class="small">Mohon tunggu</div></div></div></div>  <script>
    // helpers
    const $ = id => document.getElementById(id);
    function pad(n){return String(n).padStart(2,'0')}
    function fmtDate(d){const days=['Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu'];const months=['Januari','Februari','Maret','April','Mei','Juni','Juli','Agustus','September','Oktober','November','Desember'];return `${days[d.getDay()]}, ${d.getDate()} ${months[d.getMonth()]} ${d.getFullYear()}`}

    // clocks
    function tick(){const now=new Date();$('today').textContent=fmtDate(now);$('clock-local').textContent=`${pad(now.getHours())}:${pad(now.getMinutes())}:${pad(now.getSeconds())}`;const wib=new Date(now.toLocaleString('en-US',{timeZone:'Asia/Jakarta'}));$('clock-wib').textContent=`${pad(wib.getHours())}:${pad(wib.getMinutes())}:${pad(wib.getSeconds())}`}
    setInterval(tick,1000);tick();

    const tz = Intl.DateTimeFormat().resolvedOptions().timeZone || 'Unknown';$('region').textContent = tz;

    // theme
    const root=document.documentElement;const themeBtn=$('themeBtn');
    function applyTheme(t){root.setAttribute('data-theme',t);localStorage.setItem('handi_theme',t)}
    (function(){const saved=localStorage.getItem('handi_theme');if(saved){applyTheme(saved);}else{const prefers = window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches;applyTheme(prefers? 'light':'dark')}})();
    themeBtn.addEventListener('click',()=>applyTheme(root.getAttribute('data-theme')==='light'?'dark':'light'));

    // UA parsing + browser details
    $('ua').textContent = navigator.userAgent;
    function parseDevice(ua){const isAndroid=/Android/i.test(ua);const isIOS=/iPhone|iPad|iPod/i.test(ua);const isWin=/Windows/i.test(ua);const isMac=/Macintosh/i.test(ua);const isLinux=/Linux/i.test(ua)&&!isAndroid;const os=isAndroid?'Android':isIOS?'iOS':isWin?'Windows':isMac?'macOS':isLinux?'Linux':'Unknown';let br='Browser lain'; if(/Chrome\//.test(ua)&&!/Edg\//.test(ua)) br='Chrome'; if(/Edg\//.test(ua)) br='Edge'; if(/Firefox\//.test(ua)) br='Firefox'; if(/Safari\//.test(ua)&&!/Chrome\//.test(ua)) br='Safari'; const brVer = (ua.match(/(Chrome|Firefox|Edg|Safari)\/([0-9\.]+)/)||[])[2]||'—'; return {os,br,brVer}}
    const dv = parseDevice(navigator.userAgent); $('device').textContent = `${dv.os} • ${dv.br}`; $('browserEngine').textContent = `Engine: ${navigator.product || '—'}`; $('browserVersion').textContent = `Version: ${dv.brVer}`; $('osVersion').textContent = navigator.platform || '—';

    // GPU & WebGL info
    function getWebGLInfo(){ try{ const c = document.createElement('canvas'); const gl = c.getContext('webgl') || c.getContext('experimental-webgl'); if(!gl) return null; const dbg = gl.getExtension('WEBGL_debug_renderer_info'); const vendor = dbg ? gl.getParameter(dbg.UNMASKED_VENDOR_WEBGL) : gl.getParameter(gl.VENDOR); const renderer = dbg ? gl.getParameter(dbg.UNMASKED_RENDERER_WEBGL) : gl.getParameter(gl.RENDERER); return {vendor,renderer}; }catch(e){return null} }
    const webgl = getWebGLInfo(); if(webgl){$('gpu').textContent = `${webgl.renderer || '—'} (${webgl.vendor || '—'})`; $('webglInfo').textContent = JSON.stringify(webgl);}else{$('gpu').textContent='Tidak tersedia';$('webglInfo').textContent='—'}

    // GPU bench (simple WebGL draw loop)
    $('gpuBench').addEventListener('click',async ()=>{
      $('gpuRes').textContent='Running...';
      try{
        const canvas = document.createElement('canvas'); canvas.width=256; canvas.height=256; const gl = canvas.getContext('webgl')||canvas.getContext('experimental-webgl'); if(!gl) throw new Error('WebGL not supported');
        const start = performance.now(); let frames=0; const t= start+1500; while(performance.now()<t){ // simple clears
          gl.clearColor(Math.random(),Math.random(),Math.random(),1); gl.clear(gl.COLOR_BUFFER_BIT); frames++; }
        const dur = (performance.now()-start)/1000; $('gpuRes').textContent = `${Math.round(frames/dur)} fps (approx)`;
      }catch(e){$('gpuRes').textContent = 'Gagal: '+e.message}
    });

    // IP, ISP, ASN via ipapi & ipinfo (best-effort)
    async function fetchIPandISP(){ try{ const r = await fetch('https://ipapi.co/json/'); const j = await r.json(); $('ip').textContent = j.ip || '—'; $('isp').textContent = j.org || j.network || '—'; $('asn').textContent = j.asn || j.org || '—'; }catch(e){$('ip').textContent='Gagal';$('isp').textContent='—';$('asn').textContent='—'} }
    $('btn-ip').addEventListener('click',fetchIPandISP); fetchIPandISP();

    // WebRTC local IPs
    async function getLocalIPs(){ const ips = new Set(); try{ const pc = new RTCPeerConnection({iceServers:[]}); pc.createDataChannel(''); pc.onicecandidate = e => { if(!e.candidate) return; const s = e.candidate.candidate; const m = s.match(/([0-9]{1,3}(?:\.[0-9]{1,3}){3})/g); if(m) m.forEach(ip=>ips.add(ip)); $('localIPs').textContent = Array.from(ips).join(', '); }; const offer = await pc.createOffer(); await pc.setLocalDescription(offer); setTimeout(()=>pc.close(),2000);}catch(e){$('localIPs').textContent='Tidak tersedia'} }
    $('localIP').addEventListener('click',getLocalIPs);

    // Media devices
    async function listMedia(){ try{ const devices = await navigator.mediaDevices.enumerateDevices(); const cams = devices.filter(d=>d.kind==='videoinput'); $('mediaDevices').textContent = devices.map(d=>`${d.kind}:${d.label||'—'}`).join(' | '); return cams;}catch(e){$('mediaDevices').textContent='Gagal';return []}}
    $('scanCam').addEventListener('click',async ()=>{ const cams = await listMedia(); $('mediaDevices').textContent = `Cameras detected: ${cams.length}`});

    // camera test & resolution detection
    $('camTest').addEventListener('click',async ()=>{
      try{ const stream = await navigator.mediaDevices.getUserMedia({video:true,audio:false}); const v = $('preview'); v.srcObject = stream; v.style.display='block'; // detect resolution from track settings
        const track = stream.getVideoTracks()[0]; const s = track.getSettings(); $('camRes').textContent = `${s.width||'—'}×${s.height||'—'} (${s.deviceId? 'device':'—'})`; // stop after 6s
        setTimeout(()=>{track.stop(); v.style.display='none';},6000);
      }catch(e){alert('Gagal akses kamera: '+e.message)}
    });

    // screenshot via getDisplayMedia
    $('screenshotBtn').addEventListener('click',async ()=>{
      try{ const stream = await navigator.mediaDevices.getDisplayMedia({video:true}); const track = stream.getVideoTracks()[0]; const img = document.createElement('canvas'); const settings = track.getSettings(); img.width = settings.width || 1280; img.height = settings.height || 720; const ctx = img.getContext('2d'); const video = document.createElement('video'); video.srcObject = stream; await video.play(); ctx.drawImage(video,0,0,img.width,img.height); const data = img.toDataURL('image/png'); const a=document.createElement('a'); a.href=data; a.download='screenshot.png'; a.click(); track.stop(); }catch(e){alert('Screenshot gagal: '+e.message)}
    });

    // sensors
    if('DeviceMotionEvent' in window){window.addEventListener('devicemotion',e=>{const a=e.accelerationIncludingGravity; if(a) $('sensorVal').textContent = `Acc X:${(a.x||0).toFixed(2)} Y:${(a.y||0).toFixed(2)} Z:${(a.z||0).toFixed(2)}`;});}
    if('DeviceOrientationEvent' in window){window.addEventListener('deviceorientation',e=>{$('sensorVal').textContent = `α:${(e.alpha||0).toFixed(1)} β:${(e.beta||0).toFixed(1)} γ:${(e.gamma||0).toFixed(1)}`;});}

    // fingerprint (simple) — hashed string
    async function sha256(s){ const buf = new TextEncoder().encode(s); const h = await crypto.subtle.digest('SHA-256',buf); return Array.from(new Uint8Array(h)).map(b=>b.toString(16).padStart(2,'0')).join(''); }
    async function makeFingerprint(){ const fonts = Intl.DateTimeFormat().resolvedOptions().timeZone + '|' + navigator.language; const webglInfo = JSON.stringify(getWebGLInfo()||{}); const base = navigator.userAgent + '|' + fonts + '|' + webglInfo + '|' + (navigator.hardwareConcurrency||'') + '|' + (navigator.deviceMemory||''); const hash = await sha256(base); $('fingerprint').textContent = hash.slice(0,20); }
    makeFingerprint();

    // adblock detection
    (function detectAdblock(){ const bait = document.createElement('div'); bait.className = 'adsbox'; bait.style.height='1px'; document.body.appendChild(bait); window.setTimeout(()=>{ if(getComputedStyle(bait).display==='none' || bait.offsetParent===null){ $('adblock').textContent='AdBlock terdeteksi'}else{$('adblock').textContent='No AdBlock'} bait.remove(); },100); })();

    // incognito check improved (Chrome + Safari heuristics)
    (async function incognito(){ try{ const fs = window.RequestFileSystem || window.webkitRequestFileSystem; if(!fs){ try{ localStorage.setItem('test','1'); localStorage.removeItem('test'); $('incognito').textContent='Normal (localStorage)'; return;}catch(e){ $('incognito').textContent='Private/Restricted (localStorage)'; return;} }
      fs(window.TEMPORARY,100,()=>{$('incognito').textContent='Normal'},()=>{$('incognito').textContent='Incognito/Private'} ); }catch(e){$('incognito').textContent='Tidak pasti'} })();

    // CPU benchmark via WebWorker
    $('benchBtn').addEventListener('click',()=>{
      $('benchRes').textContent='Running...';
      const blob = new Blob([`onmessage=function(){const t0=Date.now();let c=0; for(let i=0;i<5e7;i++){ c+= (i&1); } postMessage((Date.now()-t0));}`],{type:'text/javascript'});
      const w = new Worker(URL.createObjectURL(blob)); w.onmessage = e=>{ $('benchRes').textContent = `Worker: ${e.data} ms`; w.terminate(); makeAI(); }; w.postMessage('start');
    });

    // VPN guess & more advanced network checks
    $('checkVPN').addEventListener('click',async ()=>{ $('netRes').textContent='Checking...'; try{ const r = await fetch('https://ipapi.co/json/'); const j = await r.json(); const tz_ip = j.timezone; const tz_local = Intl.DateTimeFormat().resolvedOptions().timeZone; if(tz_ip && tz_local && tz_ip.split('/')[0] !== tz_local.split('/')[0]){$('netRes').textContent = `Kemungkinan VPN/Proxy (TZ mismatch: ${tz_ip} ≠ ${tz_local})`}else{$('netRes').textContent = `IP Country: ${j.country_name} • Org: ${j.org}`;} }catch(e){$('netRes').textContent='API gagal'} });

    // AI insight
    function makeAI(){ const cores = navigator.hardwareConcurrency||2; const ram = navigator.deviceMemory||2; const heap = (performance?.memory?.usedJSHeapSize||0)/1024/1024; const notes = []; if(ram<2) notes.push('RAM rendah'); else if(ram>=8) notes.push('RAM kuat'); if(cores<=2) notes.push('CPU lemah'); if(heap>300) notes.push('Heap JS tinggi'); $('aiInsight').textContent = notes.join(' • ') || 'Normal'; }
    makeAI(); setInterval(makeAI,10000);

    // Export JSON/CSV/XLSX + PDF (jsPDF)
    function collectAll(){ return {timestamp:new Date().toISOString(), device: $('device').textContent, ua:navigator.userAgent, gpu: $('gpu').textContent, ip: $('ip').textContent, localIPs: $('localIPs').textContent, isp: $('isp').textContent, asn: $('asn').textContent, fingerprint: $('fingerprint').textContent, ai: $('aiInsight').textContent}};
    document.querySelectorAll('#exportJSON').forEach(b=>b.addEventListener('click', ()=>{ const j=JSON.stringify(collectAll(),null,2); const blob=new Blob([j],{type:'application/json'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='handidev-ultra.json'; a.click(); }));

    // PDF export
    document.querySelectorAll('#exportPDF').forEach(b=>b.addEventListener('click', async ()=>{
      if(typeof jspdf === 'undefined' && typeof window.jspdf === 'undefined'){ await new Promise((res,rej)=>{ const s=document.createElement('script'); s.src='https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js'; s.onload=res; s.onerror=rej; document.head.appendChild(s); }); }
      const { jsPDF } = window.jspdf || jspdf; const doc = new jsPDF(); doc.text('Handi Dev • Report',10,10); doc.text(JSON.stringify(collectAll(),null,2),10,20); doc.save('handidev-ultra.pdf'); }));

    // QR generator (text -> QR as dataURL)
    $('qrBtn')?.addEventListener('click', async ()=>{ if(typeof QRCode === 'undefined'){ await new Promise((res,rej)=>{ const s=document.createElement('script'); s.src='https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js'; s.onload=res; s.onerror=rej; document.head.appendChild(s); }); }
      const data = JSON.stringify(collectAll()); const w = window.open('about:blank','_blank'); w.document.write(`<div id="q"></div><pre>${data}</pre>`); const qrDiv = w.document.getElementById('q'); new w.QRCode(qrDiv, {text:data, width:240, height:240}); });// Push notification permission (PWA)
$('notifyBtn')?.addEventListener('click', async ()=>{ if(!('Notification' in window)) return alert('Notifikasi tidak didukung'); const p = await Notification.requestPermission(); if(p==='granted'){ new Notification('Handi Dev','Notifikasi diizinkan'); } else alert('Izin notifikasi: '+p); });

// File System Access (write file)
$('fsAccess')?.addEventListener('click', async ()=>{ try{ if(!window.showSaveFilePicker) return alert('File System Access API tidak didukung'); const handle = await window.showSaveFilePicker({suggestedName:'handidev-report.txt'}); const writable = await handle.createWritable(); await writable.write(JSON.stringify(collectAll(),null,2)); await writable.close(); alert('Tersimpan'); }catch(e){alert('FS Access gagal: '+e.message)} });

// Google Sign-In (placeholder) — shows flow to open google auth page (requires client/server setup)
$('signinGoogle')?.addEventListener('click', ()=>{ alert('Untuk enable Google Sign-In: sediakan OAuth Client ID. Aku bisa tambahkan langkah lengkap & contoh server verify jika mau.'); });

// service worker hook
if('serviceWorker' in navigator){ navigator.serviceWorker.register('/sw.js').then(()=>console.log('SW ok')).catch(()=>console.log('SW fail')); }

// initial fills
(async function init(){ await listMedia(); fetchIPandISP(); getLocalIPs(); makeFingerprint(); detectAdBlockInitial(); })();

function detectAdBlockInitial(){ /* reuse earlier check */ }

  </script>
</body>
</html>
